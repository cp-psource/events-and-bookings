/*! PS-Events - v1.3.9
 * https://n3rds.work/piestingtal_source/ps-events-eventmanagement-fuer-wordpress/
 * Copyright (c) 2018; * Licensed GPLv2+ */

jQuery((function(e){function t(e){var t,a;if(t=!1,""!=jQuery("#psource_event_start_"+e).val()&&(t=new Date(jQuery("#psource_event_start_"+e).val()),""!=jQuery("#psource_event_start_time_"+e).val()||jQuery("#psource_event_no_start_time_"+e).is(":checked"))){var r=(jQuery("#psource_event_no_start_time_"+e).is(":checked")?"00:01":jQuery("#psource_event_start_time_"+e).val()).split(/:/gi);t.setHours(r[0]),t.setMinutes(r[1])}if(a=!1,jQuery("#psource_event_end_"+e).length&&""!=jQuery("#psource_event_end_"+e).val()&&(a=new Date(jQuery("#psource_event_end_"+e).val()),""!=jQuery("#psource_event_end_time_"+e).val()||jQuery("#psource_event_no_end_time_"+e).is(":checked"))){var n=(jQuery("#psource_event_no_end_time_"+e).is(":checked")?"23:59":jQuery("#psource_event_end_time_"+e).val()).split(/:/gi);a.setHours(n[0]),a.setMinutes(n[1])}return[t,a]}function a(e){return"bank"==e||(!!jQuery("#icl_translation_of").length||(a=!!(n=t(e)).length&&n[0],r=!!n.length&&n[1],!a||!r||a.getTime()>=r.getTime()?(jQuery("#psource_event_start_"+e).addClass("error"),jQuery("#psource_event_start_time_"+e).addClass("error"),jQuery("#psource_event_end_"+e).addClass("error"),jQuery("#psource_event_end_time_"+e).addClass("error"),jQuery("input.button-primary.button-large").attr("disabled",!0),!1):(jQuery("#psource_event_start_"+e).removeClass("error"),jQuery("#psource_event_start_time_"+e).removeClass("error"),jQuery("#psource_event_end_"+e).removeClass("error"),jQuery("#psource_event_end_time_"+e).removeClass("error"),jQuery("input.button-primary.button-large").removeAttr("disabled"),!0)));var a,r,n}jQuery(".psource_event_picker").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,defaultDate:new Date,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),jQuery("body").on("focus",".psource_event_time_picker",(function(){e(this).timepicker({showNowButton:!0,showDeselectButton:!0,showCloseButton:!0})})),jQuery('[href*="preview=true"]').hide(),jQuery("#eab-add-more").show(),jQuery("#eab-add-more-button").on("click",(function(){row_id=jQuery(".eab-start-section").length-1,jQuery("#eab-add-more-rows").append(jQuery("#eab-add-more-bank").html().replace(/_bank/gi,"_"+row_id).replace(/bank/gi,row_id+1).replace(/_b/gi,"")),jQuery("#psource_event_start_"+row_id+" , #psource_event_end_"+row_id).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),jQuery("#psource_event_start_time_"+row_id+" , #psource_event_end_time_"+row_id).timepicker({showNowButton:!0,showDeselectButton:!0,showCloseButton:!0}),jQuery(".eab-section-block").length>2&&jQuery(".eab-section-heading").show()})),jQuery("body").on("click",".eab-event-remove_time",(function(){var e=jQuery(this),t=e.parents("#eab-add-more-rows").find(".eab-start-section"),a=e.parents(".eab-section-block");return!(t.length<=1)&&(!!a.length&&(a.remove(),!1))})),jQuery("#psource_event-accept_payments").is(":checked")||jQuery("#eab-settings-paypal").hide(),jQuery("#psource_event-accept_payments").on("change",(function(){jQuery("#psource_event-accept_payments").is(":checked")?jQuery("#eab-settings-paypal").show():jQuery("#eab-settings-paypal").hide()})),0==jQuery("#psource_event_paid").val()&&jQuery(".psource_event-fee_row").hide(),jQuery("#psource-event").on("change","#psource_event_paid",(function(){0==jQuery("#psource_event_paid").val()?jQuery(".psource_event-fee_row").hide():jQuery(".psource_event-fee_row").show()})),jQuery("a.eab-info").on("click",(function(){return jQuery(jQuery(this).attr("href")).toggle(),!1})),jQuery("#psource-event-bookings").hasClass("closed")||jQuery("#psource-event-bookings").addClass("closed"),jQuery("#psource-event-bookings .hndle").append('<span class="eab-expand-metabox">'+eab_event_localized.view_all_bookings+"</span>"),jQuery("#psource-event-wizard").hasClass("closed")||jQuery("#psource-event-wizard").addClass("closed"),jQuery("#psource-event-wizard .hndle").append('<a href="edit.php?post_type=psource_event&page=eab_welcome" class="eab-expand-metabox">'+eab_event_localized.back_to_gettting_started+"</a>"),2==jQuery(".eab-section-block").length&&jQuery(".eab-section-heading").hide(),jQuery("#psource-event").on("change","input.psource_event",(function(){a(jQuery(this).attr("id").replace(/psource_event_[a-z_]+_/gi,""))})),jQuery("#psource-event").on("change",".psource_event_no_start_time",(function(){var e=jQuery(this),t=e.attr("id").replace(/psource_event_[a-z_]+_/gi,"");e.is(":checked")?jQuery("#psource_event_start_time_"+t).hide():jQuery("#psource_event_start_time_"+t).show()})),jQuery(".psource_event_no_start_time").each((function(){jQuery(this).trigger("change")})),jQuery("#psource-event").on("change",".psource_event_no_end_time",(function(){var e=jQuery(this),t=e.attr("id").replace(/psource_event_[a-z_]+_/gi,"");e.is(":checked")?jQuery("#psource_event_end_time_"+t).hide():jQuery("#psource_event_end_time_"+t).show()})),jQuery(".psource_event_no_end_time").each((function(){jQuery(this).trigger("change")})),jQuery("#psource-event").on("change",".psource_event_start",(function(){var e,a,r=jQuery(this),n=r.parents(".eab-section-block").find(".psource_event_end"),o=r.attr("id").replace(/psource_event_[a-z_]+_/gi,"");return!n.length||(e=!!(a=t(o)).length&&a[0],!!a.length&&a[1],!e||!e.getTime||void n.datepicker("option","defaultDate",e))})),jQuery("form#post").on("submit",(function(){if(_c=0,jQuery("#eab_event-repeat_start").is(":visible"))return!0;if(a(_c))return jQuery("#ajax-loading").show(),jQuery("#publish").removeClass("button-primary-disabled"),!0;var e=jQuery("#psource_event_times_label"),t=e.length?e.offset().top:0;jQuery("#ajax-loading").hide(),jQuery("#publish").removeClass("button-primary-disabled"),jQuery("html,body").scrollTop(t);for(var r=0;r<3;r++)jQuery(".psource_event_date.error").animate({"border-width":3}).animate({"border-width":1});return!1})),_eab_location=window.location,function(e){function t(){e("#psource_event-accept_api_logins").is(":checked")?e("#eab-settings-apis .eab-inside").show():e("#eab-settings-apis .eab-inside").hide()}function r(){e("#psource_event-override_appearance_defaults").is(":checked")?(e("#psource_event-archive_template").attr("disabled",!1),e("#psource_event-single_template").attr("disabled",!1)):(e("#psource_event-archive_template").attr("disabled",!0),e("#psource_event-single_template").attr("disabled",!0))}function n(){var t=e("#eab-eab-start_recurrence-button").val(),a=e("#eab-eab-start_recurrence-button").attr("data-eab-alter_label");return e("#eab-eab-start_recurrence-button").val(a),e("#eab-eab-start_recurrence-button").attr("data-eab-alter_label",t),e("#eab_event-recurring_event").is(":visible")?(e("#eab_event-recurring_event").hide(),e("#eab-add-more-rows").show(),e("#eab-add-more").show(),e("#edit-slug-box").show()):(e("#eab_event-recurring_event").show(),e("#eab-add-more-rows").hide(),e("#eab-add-more").hide(),e("#eab_event-repeat_start,#eab_event-repeat_end").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),e("#edit-slug-box").hide(),o(!0)),!1}function o(t){e(".eab_event_recurrence_mode").hide();var a=e("#eab_event-repeat_every").val();if(!a&&void 0!==t)return e("#publish").attr("disabled",!0),!1;var r=e("#eab_event-repeat_interval-"+a);if(!r.length)return!1;e(".eab_event_recurrence_mode").find("input,select").attr("disabled",!0),r.find("input,select").attr("disabled",!1),e("#publish").attr("disabled",!1),r.show(),e("#eab_event-repeat_start,#eab_event-repeat_end").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0})}function s(){return e("#eab_event-recurring_instances").is(":visible")?e("#eab_event-recurring_instances").hide():e("#eab_event-recurring_instances").show(),!1}e((function(){e("#psource_event-accept_api_logins").on("change",t),t(),e("#psource_event-override_appearance_defaults").on("change",r),r(),e(".eab-restart_tutorial").on("click",(function(){var t=e(this);return e.post(ajaxurl,{action:"eab_restart_tutorial",step:t.attr("data-eab_tutorial")},(function(){window.location.reload()})),!1})),e("#eab-eab-start_recurrence-button").on("click",n),e("#eab_event-repeat_every").on("change",o),o(),e("#eab_event-edit_recurring_instances").on("click",s),e("#eab_event-repeat_every").is(":visible")&&e("#edit-slug-box").hide(),e("body").on("click",".eab-guest-cancel_attendance",(function(){var t=e(this),a=t.attr("data-eab-user_id"),r=t.attr("data-eab-event_id");return e.post(ajaxurl,{action:"eab_cancel_attendance",user_id:a,post_id:r},(function(t){e("#eab-bookings-response").html(t)})),!1})),e("body").on("click",".eab-guest-delete_attendance",(function(){var t=e(this),a=t.attr("data-eab-user_id"),r=t.attr("data-eab-event_id");return e.post(ajaxurl,{action:"eab_delete_attendance",user_id:a,post_id:r},(function(t){e("#eab-bookings-response").html(t)})),!1})),e("body").on("click",".eab-add_attendance .button",(function(){var t=e(".eab-add_attendance"),a=t.find(".eab-attendance-event_id").val();return email=t.find(".eab-attendance-email").val(),status=t.find(".eab-attendance-status").val(),!!(a&&email&&status)&&(e.post(ajaxurl,{action:"eab_add_attendance",user:email,post_id:a,status:status},(function(t){e("#eab-bookings-response").html(t)})),!1)})),e("#psource-event input.psource_event").each((function(){a(e(this).attr("id").replace(/psource_event_[a-z_]+_/gi,""))}))}))}(jQuery),function(e){var t=e(window),a=!1;if(!window.location.search.match("page=eab_settings"))return!1;if(t.width()<768)return!1;if(!e(".wrap").is(".tabbable"))return!1;function r(t){t.preventDefault(),t.stopPropagation();var a=e(this),r=a.attr("data-box_id"),n=!1;r&&(n=e("#"+r)),r&&r.length&&(e("#eab-root-settings_nav h3").removeClass("active"),a.addClass("active"),e(".eab-metabox.postbox").hide(),n.show(),window.location.hash=r,o())}function n(){var n=e(".eab-metabox.postbox"),s=e(".eab-metaboxcol.metabox-holder");if(a=a.length?a:s.siblings(".submit"),n.length){var i=e("#eab-root-settings_nav");if(i.length)return t.width()<768&&(s.removeClass("tabbed"),i.remove(),n.show()),void s.append(a);s.prepend('<div id="eab-root-settings_nav"></div>'),(i=e("#eab-root-settings_nav")).empty(),n.each((function(){var t=e(this),a=t.attr("id"),n=t.find("h3.eab-hndle").clone();a&&(n.attr("data-box_id",a).on("click",r),i.append(n),t.hide())})),s.append(a);var _=window.location.hash;if(_=_.split("#")[1]){var c=i.find('h3[data-box_id="'+_+'"]');c.length?c.on("click"):i.find("h3:first").on("click")}else i.find("h3:first").on("click");o(),s.addClass("tabbed"),e(".eab-loading-cover.tabbable").remove(),e(".wrap.tabbable.hide").removeClass("hide")}}function o(){var t=window.location;e(".event_settings_url").val(t)}e(n),t.on("resize",n)}(jQuery)}));